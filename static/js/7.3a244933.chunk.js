(this.webpackJsonpsocial_web_ts=this.webpackJsonpsocial_web_ts||[]).push([[7],{549:function(e,n,t){"use strict";t.r(n);var a=t(56),l=t(159),c=t(0),r=t.n(c),o=function(){var e=Object(c.useState)(null),n=Object(l.a)(e,2),t=n[0],a=n[1];return Object(c.useEffect)((function(){var e,n=function(){console.log("Socket is closed. Reconnect will be attempted in 3 second."),setTimeout((function(){t()}),3e3)},t=function(){var t,l,c;null===(t=e)||void 0===t||t.removeEventListener("close",n),null===(l=e)||void 0===l||l.close(),e=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"),a(e),null===(c=e)||void 0===c||c.addEventListener("close",n)};return t(),function(){e.removeEventListener("close",n),e.close()}}),[]),r.a.createElement("div",null,r.a.createElement(s,{wsChannel:t}),r.a.createElement(u,{wsChannel:t}))},u=function(e){var n=e.wsChannel,t=Object(c.useState)(""),a=Object(l.a)(t,2),o=a[0],u=a[1],s=Object(c.useState)("pending"),i=Object(l.a)(s,2),v=i[0],d=i[1];Object(c.useEffect)((function(){var e=function(){d("open")};return null===n||void 0===n||n.addEventListener("open",e),function(){null===n||void 0===n||n.removeEventListener("close",e)}}),[n]);return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("textarea",{value:o,onChange:function(e){return u(e.currentTarget.value)}})),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){o&&(null===n||void 0===n||n.send(o),u(""))},disabled:null===n||"open"!==v},"Send")))},s=function(e){var n=e.wsChannel,t=Object(c.useState)([]),o=Object(l.a)(t,2),u=o[0],s=o[1],v=Object(c.useRef)(null);Object(c.useEffect)((function(){!function(){var e;null===(e=v.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}()}),[u]);var d=function(e){console.log(JSON.parse(e.data));var n=JSON.parse(e.data);s((function(e){return[].concat(Object(a.a)(e),Object(a.a)(n))}))};return Object(c.useEffect)((function(){return null===n||void 0===n||n.addEventListener("message",d),function(){null===n||void 0===n||n.removeEventListener("message",d),null===n||void 0===n||n.close()}}),[n]),r.a.createElement("div",{style:{height:"400px",overflowY:"scroll"}},u.map((function(e,n){return r.a.createElement(i,{key:n,message:e})})),r.a.createElement("div",{ref:v}))},i=function(e){var n=e.message;return r.a.createElement("div",null,r.a.createElement("img",{src:n.photo,alt:"mess"})," ",r.a.createElement("b",null,n.userName),r.a.createElement("br",null),n.message,r.a.createElement("hr",null))};n.default=function(){return r.a.createElement("div",null,r.a.createElement(o,null))}}}]);
//# sourceMappingURL=7.3a244933.chunk.js.map